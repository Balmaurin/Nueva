(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{670:function(e,t,r){Promise.resolve().then(r.t.bind(r,7960,23)),Promise.resolve().then(r.bind(r,6281))},6281:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return i},a:function(){return a}});var o=r(7437),n=r(2265);let s=(0,n.createContext)(void 0),a=()=>{let e=(0,n.useContext)(s);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},i=e=>{let{children:t}=e,[r,a]=(0,n.useState)(null),[i,u]=(0,n.useState)(null),[l,c]=(0,n.useState)(!0);(0,n.useEffect)(()=>{let e=localStorage.getItem("auth_token");e?(u(e),h(e)):c(!1)},[]);let h=async e=>{try{let t=await fetch("http://localhost:8000/api/auth/profile",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();a(e.user)}else localStorage.removeItem("auth_token"),u(null),a(null)}catch(e){console.error("Error verificando token:",e),localStorage.removeItem("auth_token"),u(null),a(null)}finally{c(!1)}},d=async(e,t)=>{try{let r=await fetch("http://localhost:8000/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})}),o=await r.json();if(!r.ok||!o.token)return{success:!1,message:o.message||"Credenciales inv\xe1lidas"};{let{user:e,token:t,message:r}=o;return a(e),u(t),localStorage.setItem("auth_token",t),{success:!0,message:r||"Inicio de sesi\xf3n exitoso"}}}catch(e){return console.error("Error en login:",e),{success:!1,message:"Error de conexi\xf3n"}}},f=async(e,t,r)=>{try{let o=await fetch("http://localhost:8000/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,email:t,password:r})}),n=await o.json();if(o.ok&&!n.error)return{success:!0,message:"Usuario registrado exitosamente. Ahora puedes iniciar sesi\xf3n."};return{success:!1,message:n.error||"Error al registrar usuario"}}catch(e){return console.error("Error en registro:",e),{success:!1,message:"Error de conexi\xf3n"}}};return(0,o.jsx)(s.Provider,{value:{user:r,token:i,login:d,register:f,logout:()=>{a(null),u(null),localStorage.removeItem("auth_token")},isLoading:l,isAuthenticated:!!r&&!!i},children:t})}},7960:function(){}},function(e){e.O(0,[587,971,117,744],function(){return e(e.s=670)}),_N_E=e.O()}]);